<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ordre de Mission</title>
  <style>
    /* Police: évite les @import Google Fonts en headless, garde Roboto si dispo, sinon Arial */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      font-family: Roboto, Arial, sans-serif;
      color: #000;
      background: #fff;
      line-height: 1.2;
      font-size: 10px;
    }

    .page {
      width: 210mm; height: 297mm;
      padding: 10mm 12mm 15mm 12mm;
      margin: 0 auto;
      display: flex; flex-direction: column;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }

    /* ========= Header ========= */
    .header { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; }
    .rep-ar { text-align: center; direction: rtl; }
    .rep-ar .title { font-weight: 700; font-size: 12px; }
    .rep-ar .motto { font-size: 10px; }

    .coat { width: 60px; height: 60px; background: url('{{COAT_OF_ARMS_BASE64}}') center/contain no-repeat; }

    .rep-fr { text-align: center; }
    .rep-fr .title { font-weight: 700; font-size: 10px; }
    .rep-fr .motto { font-size: 9px; }

    .hr { border-bottom: 2px solid #8b4513; margin: 6px 0 6px 0; }

    /* ========= Ministry / Agency ========= */
    .ministry { display: grid; grid-template-columns: 1fr; gap: 4px; text-align: center; }
    .ministry .ar { direction: rtl; font-weight: 700; font-size: 11px; }
    .ministry .fr { font-weight: 700; font-size: 10px; text-transform: uppercase; }

    .masthead {
      display: grid; grid-template-columns: auto 1fr auto; gap: 10px; align-items: center; margin-top: 4px;
    }
    .logo {
      width: 150px; height: 60px; display: flex; align-items: center; justify-content: center;
      border: 1px solid #ddd; padding: 4px; border-radius: 4px;
    }
    .logo img { width: 100%; height: 100%; object-fit: contain; }

    .agency-text { font-weight: 700; font-size: 10px; }
    .director {
      text-align: right;
    }
    .director .ar { direction: rtl; font-weight: 700; font-size: 9px; }
    .director .fr { font-weight: 700; font-size: 9px; }

    .meta {
      display: grid; grid-template-columns: repeat(3, auto); gap: 8px; justify-content: end; margin-top: 3px;
      font-weight: 700; font-size: 9px;
    }
    .meta .box { display: grid; grid-auto-flow: column; align-items: center; gap: 4px; }
    .meta .value { color: #0047ff; }

    /* ========= Title ========= */
    .doc-title { text-align: center; margin: 6px 0 4px 0; }
    .doc-title .t { font-size: 16px; font-weight: 800; letter-spacing: .3px; }
    .underline { width: 150px; height: 2px; background: #000; margin: 4px auto 0; }

    /* ========= Blocks ========= */
    .block { border: 1px solid #000; border-radius: 3px; margin-top: 6px; }
    .block .block-title {
      background: #f2f6ff; border-bottom: 1px solid #000; padding: 4px 8px; font-weight: 800; text-align: center; font-size: 9px;
    }
    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { border: 1px solid #000; padding: 3px 6px; vertical-align: top; font-size: 9px; }
    .table th { width: 150px; background: #f7f7f7; text-align: left; font-weight: 700; }

    /* Compact helper */
    .muted { color: #444; font-weight: 600; }

    /* ========= Signature / Seal ========= */
    .sign-row {
      display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: end; margin-top: 12px;
    }
    .sign-box { text-align: center; width: 200px; }
    .sign-name { font-weight: 800; margin-bottom: 4px; font-size: 9px; }
    .signature {
      width: 100%; height: 80px; background: center/contain no-repeat;
      border: 1px dashed #bbb; border-radius: 4px; margin: 4px 0 6px 0;
    }
    .stamp {
      width: 80px; height: 80px; background: center/contain no-repeat; margin: 0 auto;
    }

    /* ========= Footer & QR ========= */
    .qr { position: absolute; left: 12mm; bottom: 20mm; width: 60px; height: 60px; border: 1px solid #ddd;
          background: url('{{QR_CODE_DATA_URL}}') center/contain no-repeat; }
    .qr-label { position: absolute; left: 12mm; bottom: 16mm; font-size: 7px; color: #666; text-align: center; width: 60px; }

    .footer {
      position: absolute; left: 12mm; right: 12mm; bottom: 8mm; border-top: 1px solid #000;
      padding-top: 4px; text-align: center; font-size: 8px; line-height: 1.3;
    }
    .footer .line { margin: 0.5px 0; }
    .footer .ar { direction: rtl; }

    @media print {
      .page { box-shadow: none; }
    }
  </style>
</head>
<body>
  <div class="page">

    <!-- ===== Header ===== -->
    <div class="header">
      <div class="rep-ar">
        <div class="title">الجمهورية الإسلامية الموريتانية</div>
        <div class="motto">شرف - إخاء - عدل</div>
      </div>
      <div class="coat"></div>
      <div class="rep-fr">
        <div class="title">RÉPUBLIQUE ISLAMIQUE DE MAURITANIE</div>
        <div class="motto">Honneur - Fraternité - Justice</div>
      </div>
    </div>
    <div class="hr"></div>

    <!-- ===== Ministry / Agency ===== -->
    <div class="ministry">
      <div class="ar">وزارة الإسكان والعمران والاستصلاح الترابي</div>
      <div class="fr">MINISTERE DE L'HABITAT, DE L'URBANISME ET DE L'AMENAGEMENT DU TERRITOIRE</div>
    </div>

    <div class="masthead">
      <div class="logo">
        <img src="{{AGENCY_LOGO_BASE64}}" alt="ANESP Logo"/>
      </div>
      <div class="agency-text">
        Agence Nationale d’Exécution et de Suivi des Projets (ANESP)
      </div>
      <div class="director">
        <div class="ar">المديرة العامة</div>
        <div class="fr">La Directrice Générale</div>
      </div>
    </div>

    <div class="meta">
      <div class="box"><span class="muted">NOUAKCHOTT, LE</span> <span class="value">{{DATE_VALUE}}</span></div>
      <div class="box"><span class="muted">N°</span> <span class="value">{{MISSION_NUMBER}}</span></div>
      <div class="box"><span class="muted">نواكشوط، في</span> <span class="value">{{DATE_VALUE}}</span></div>
    </div>

    <!-- ===== Title ===== -->
    <div class="doc-title">
      <div class="t">ORDRE DE MISSION</div>
      <div class="underline"></div>
    </div>

    <!-- ===== Mission ===== -->
    <div class="block">
      <div class="block-title">Détails de la mission</div>
      <table class="table">
        <tr>
          <th>Objet de la mission</th>
          <td>{{OBJECTIVE}}</td>
        </tr>
        <tr>
          <th>Ville de départ</th>
          <td>{{DEPARTURE_CITY}}</td>
        </tr>
        <tr>
          <th>Ville d'arrivée</th>
          <td>{{ARRIVAL_CITY}}</td>
        </tr>
        <tr>
          <th>Mode de transport</th>
          <td>{{TRANSPORT_MODE}}</td>
        </tr>
        <tr>
          <th>Date de départ</th>
          <td>{{DEPARTURE_DATE}}</td>
        </tr>
        <tr>
          <th>Date de retour (fin)</th>
          <td>{{RETURN_DATE}}</td>
        </tr>
      </table>
    </div>

    <!-- ===== Participants ===== -->
    <div class="block">
      <div class="block-title">Participants</div>
      <table class="table">
        {{PARTICIPANTS_TABLE_ROWS}}
      </table>
    </div>

    <!-- ===== Chauffeur & Véhicule ===== -->
    <div class="block">
      <div class="block-title">Moyens logistiques</div>
      <table class="table">
        <tr>
          <th>Chauffeur</th>
          <td>{{DRIVER_NAME}} &nbsp;&nbsp;|&nbsp;&nbsp; {{DRIVER_PHONE}}</td>
        </tr>
        <tr>
          <th>Véhicule</th>
          <td>Matricule: {{VEHICLE_PLATE}} &nbsp;&nbsp;|&nbsp;&nbsp; Modèle: {{VEHICLE_MODEL}}</td>
        </tr>
      </table>
    </div>

    <!-- ===== Signature / Cachet ===== -->
    <div class="sign-row">
      <div></div>
      <div class="sign-box">
        <div class="sign-name">{{SIGNER_NAME}}<br/>La Directrice Générale</div>
        <div class="signature" style="background-image: url('{{SIGNATURE_BASE64}}');"></div>
        <div class="stamp" style="background-image: url('{{STAMP_BASE64}}');"></div>
      </div>
    </div>

    <!-- ===== QR & Footer ===== -->
    <div class="qr"></div>
    <div class="qr-label">Scan pour vérification</div>

    <div class="footer">
      <div class="line">
        📍 Ilot V, lot.90, Rue Gandhi, BP : 7985 Nouakchott, Mauritanie &nbsp;|&nbsp;
        ☎ 00.222 45 24 14 78 &nbsp;|&nbsp;
        ✉ info@anesp.mr &nbsp;|&nbsp;
        🌐 anesp.mr
      </div>
      <div class="line ar">
        📍 إيلوت V، رقم 90، شارع غاندي، ص.ب : 7985 نواكشوط - موريتانيا &nbsp;|&nbsp;
        ☎ 00.222 45 24 14 78 &nbsp;|&nbsp;
        ✉ info@anesp.mr &nbsp;|&nbsp;
        🌐 anesp.mr
      </div>
    </div>

  </div>
</body>
</html>
